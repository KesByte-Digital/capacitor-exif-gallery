{"version":3,"file":"errors.js","sourceRoot":"","sources":["../../src/errors.ts"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;GA2BG;AAaH;;;;;;;;;;;;;GAaG;AACH,MAAM,OAAO,gBAAiB,SAAQ,KAAK;IAOzC,YAAY,IAA0B,EAAE,OAAe;QACrD,KAAK,CAAC,OAAO,CAAC,CAAC;QACf,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;QACjB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC;QAElC,0DAA0D;QAC1D,IAAI,KAAK,CAAC,iBAAiB,EAAE,CAAC;YAC5B,+BAA+B;YAC/B,KAAK,CAAC,iBAAiB,CAAC,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;QAClD,CAAC;aAAM,CAAC;YACN,2BAA2B;YAC3B,IAAI,CAAC,KAAK,GAAG,IAAI,KAAK,EAAE,CAAC,KAAK,CAAC;QACjC,CAAC;IACH,CAAC;CACF;AAED;;;;;;;;;;;;;;;;;;;;;GAqBG;AACH,MAAM,OAAO,2BAA4B,SAAQ,gBAAgB;IAC/D,YAAY,OAAO,GAAG,kDAAkD;QACtE,KAAK,CAAC,yBAAyB,EAAE,OAAO,CAAC,CAAC;IAC5C,CAAC;CACF;AAED;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GA+BG;AACH,MAAM,OAAO,qBAAsB,SAAQ,gBAAgB;IACzD,YAAY,OAAO,GAAG,wDAAwD;QAC5E,KAAK,CAAC,oBAAoB,EAAE,OAAO,CAAC,CAAC;IACvC,CAAC;CACF;AAOD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GAyCG;AACH,MAAM,OAAO,iBAAkB,SAAQ,gBAAgB;IAMrD,YAAY,iBAAiC,eAAe,EAAE,OAAgB;QAC5E,MAAM,cAAc,GAClB,cAAc,KAAK,eAAe,CAAC,CAAC,CAAC,iCAAiC,CAAC,CAAC,CAAC,4BAA4B,CAAC;QACxG,KAAK,CAAC,eAAe,EAAE,OAAO,aAAP,OAAO,cAAP,OAAO,GAAI,cAAc,CAAC,CAAC;QAClD,IAAI,CAAC,cAAc,GAAG,cAAc,CAAC;IACvC,CAAC;CACF;AAED;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GAiDG;AACH,MAAM,OAAO,WAAY,SAAQ,gBAAgB;IAC/C,YAAY,OAAe;QACzB,6BAA6B;QAC7B,IAAI,OAAO,OAAO,KAAK,QAAQ,EAAE,CAAC;YAChC,MAAM,IAAI,SAAS,CAAC,6CAA6C,GAAG,OAAO,OAAO,CAAC,CAAC;QACtF,CAAC;QAED,gEAAgE;QAChE,MAAM,YAAY,GAAG,OAAO,CAAC,OAAO,CAAC,mBAAmB,EAAE,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC;QAErE,oDAAoD;QACpD,IAAI,CAAC,YAAY,EAAE,CAAC;YAClB,KAAK,CAAC,cAAc,EAAE,2BAA2B,CAAC,CAAC;YACnD,0CAA0C;YAC1C,IAAI,OAAO,OAAO,KAAK,WAAW,IAAI,OAAO,CAAC,IAAI,EAAE,CAAC;gBACnD,OAAO,CAAC,IAAI,CAAC,mDAAmD,EAAE,OAAO,CAAC,CAAC;YAC7E,CAAC;QACH,CAAC;aAAM,CAAC;YACN,KAAK,CAAC,cAAc,EAAE,YAAY,CAAC,CAAC;QACtC,CAAC;IACH,CAAC;CACF;AAED;;;;;;;;;;;;;;;;;;;;;;;;;;;GA2BG;AACH,MAAM,OAAO,WAAY,SAAQ,gBAAgB;IAC/C,YAAY,OAAO,GAAG,kCAAkC;QACtD,KAAK,CAAC,cAAc,EAAE,OAAO,CAAC,CAAC;IACjC,CAAC;CACF","sourcesContent":["/**\n * Error types thrown by the ExifGallery Plugin.\n *\n * All errors extend ExifGalleryError for easy type checking.\n * Each error has a unique code for programmatic handling.\n *\n * @example\n * ```typescript\n * import { ExifGallery, InitializationRequiredError, NoPermissionError } from '@kesbyte/capacitor-exif-gallery';\n *\n * try {\n *   const result = await ExifGallery.pick();\n * } catch (error) {\n *   if (error instanceof InitializationRequiredError) {\n *     // Plugin not initialized - call initialize() first\n *     await ExifGallery.initialize();\n *     // Retry pick()\n *     const result = await ExifGallery.pick();\n *   } else if (error instanceof NoPermissionError) {\n *     // User denied permissions - show explanation and retry\n *     alert('Photo access required to select images');\n *   } else if (error instanceof FilterError) {\n *     // Invalid filter parameters - fix and retry\n *     console.error('Invalid filter:', error.message);\n *   }\n * }\n * ```\n */\n\n/**\n * Error codes for all ExifGallery Plugin errors.\n * Used for programmatic error handling with type safety.\n */\nexport type ExifGalleryErrorCode =\n  | 'initialization_required'\n  | 'picker_in_progress'\n  | 'no_permission'\n  | 'filter_error'\n  | 'native_error';\n\n/**\n * Base class for all ExifGallery Plugin errors.\n *\n * @example\n * ```typescript\n * try {\n *   await ExifGallery.pick();\n * } catch (error) {\n *   if (error instanceof ExifGalleryError) {\n *     console.error(`Plugin error [${error.code}]:`, error.message);\n *   }\n * }\n * ```\n */\nexport class ExifGalleryError extends Error {\n  /**\n   * Error code for programmatic handling.\n   * Typed as union for compile-time safety and autocomplete.\n   */\n  public readonly code: ExifGalleryErrorCode;\n\n  constructor(code: ExifGalleryErrorCode, message: string) {\n    super(message);\n    this.code = code;\n    this.name = this.constructor.name;\n\n    // Maintains proper stack trace for where error was thrown\n    if (Error.captureStackTrace) {\n      // V8 engines (Chrome, Node.js)\n      Error.captureStackTrace(this, this.constructor);\n    } else {\n      // Safari, Firefox fallback\n      this.stack = new Error().stack;\n    }\n  }\n}\n\n/**\n * Thrown when pick() is called before initialize().\n *\n * **Resolution:** Call initialize() before calling pick().\n *\n * @example\n * ```typescript\n * import { ExifGallery, InitializationRequiredError } from '@kesbyte/capacitor-exif-gallery';\n *\n * try {\n *   // ERROR: calling pick() without initialize()\n *   const result = await ExifGallery.pick();\n * } catch (error) {\n *   if (error instanceof InitializationRequiredError) {\n *     // Fix: Initialize plugin first\n *     await ExifGallery.initialize();\n *     // Retry pick()\n *     const result = await ExifGallery.pick();\n *   }\n * }\n * ```\n */\nexport class InitializationRequiredError extends ExifGalleryError {\n  constructor(message = 'Plugin must be initialized before calling pick()') {\n    super('initialization_required', message);\n  }\n}\n\n/**\n * Thrown when pick() is called while another picker is already in progress.\n *\n * **Resolution:** Wait for the first pick() to complete before calling again.\n *\n * @example\n * ```typescript\n * import { ExifGallery, PickerInProgressError } from '@kesbyte/capacitor-exif-gallery';\n *\n * // Track picker state\n * let isPickerOpen = false;\n *\n * async function selectImages() {\n *   if (isPickerOpen) {\n *     console.log('Picker already open');\n *     return;\n *   }\n *\n *   try {\n *     isPickerOpen = true;\n *     const result = await ExifGallery.pick();\n *     // Handle result...\n *   } catch (error) {\n *     if (error instanceof PickerInProgressError) {\n *       console.log('Another picker is open, please wait');\n *     }\n *   } finally {\n *     isPickerOpen = false;\n *   }\n * }\n * ```\n */\nexport class PickerInProgressError extends ExifGalleryError {\n  constructor(message = 'Cannot open picker while another picker is in progress') {\n    super('picker_in_progress', message);\n  }\n}\n\n/**\n * Permission types that can be denied.\n */\nexport type PermissionType = 'photo_library' | 'location';\n\n/**\n * Thrown when user denies photo library or location permissions.\n *\n * **Resolution:**\n * - Check `permissionType` to show specific guidance\n * - Explain why permission is needed\n * - Guide user to Settings to enable permission\n * - Request permission again on next attempt\n *\n * @example\n * ```typescript\n * import { ExifGallery, NoPermissionError } from '@kesbyte/capacitor-exif-gallery';\n *\n * try {\n *   const result = await ExifGallery.pick({\n *     filter: {\n *       location: {\n *         coordinates: [{ lat: 48.8566, lng: 2.3522 }],\n *         radius: 500\n *       }\n *     }\n *   });\n * } catch (error) {\n *   if (error instanceof NoPermissionError) {\n *     // Show context-specific guidance\n *     if (error.permissionType === 'photo_library') {\n *       await showPermissionDialog(\n *         'Photo Access Required',\n *         'This app needs access to your photos to let you select images. ' +\n *         'Please enable photo access in Settings.'\n *       );\n *     } else if (error.permissionType === 'location') {\n *       await showPermissionDialog(\n *         'Location Access Required',\n *         'This app needs location access to filter photos by location. ' +\n *         'Please enable location access in Settings.'\n *       );\n *     }\n *   }\n * }\n * ```\n */\nexport class NoPermissionError extends ExifGalleryError {\n  /**\n   * The type of permission that was denied.\n   */\n  public readonly permissionType: PermissionType;\n\n  constructor(permissionType: PermissionType = 'photo_library', message?: string) {\n    const defaultMessage =\n      permissionType === 'photo_library' ? 'Photo library permission denied' : 'Location permission denied';\n    super('no_permission', message ?? defaultMessage);\n    this.permissionType = permissionType;\n  }\n}\n\n/**\n * Thrown when filter parameters are invalid.\n *\n * **Common causes:**\n * - Empty coordinates/polyline arrays\n * - Invalid LatLng coordinates (out of bounds)\n * - Negative or zero radius\n * - Invalid date range (end before start)\n * - Infinite or NaN numeric values\n * - Arrays exceeding size limits\n *\n * **Resolution:** Fix the filter parameters based on the error message.\n *\n * @example\n * ```typescript\n * import { ExifGallery, FilterError } from '@kesbyte/capacitor-exif-gallery';\n *\n * try {\n *   const result = await ExifGallery.pick({\n *     filter: {\n *       location: {\n *         coordinates: [], // ERROR: empty array\n *         radius: -100     // ERROR: negative radius\n *       }\n *     }\n *   });\n * } catch (error) {\n *   if (error instanceof FilterError) {\n *     // error.message contains specific validation error\n *     console.error('Invalid filter:', error.message);\n *\n *     // Fix and retry\n *     const result = await ExifGallery.pick({\n *       filter: {\n *         location: {\n *           coordinates: [{ lat: 48.8566, lng: 2.3522 }], // Fixed\n *           radius: 500 // Fixed\n *         }\n *       }\n *     });\n *   }\n * }\n *\n * // Validation errors include details:\n * // - \"coordinates must contain at least one coordinate\"\n * // - \"radius must be greater than 0\"\n * // - \"polyline[2] is not a valid LatLng coordinate\"\n * // - \"timeRange.start must be before timeRange.end\"\n * ```\n */\nexport class FilterError extends ExifGalleryError {\n  constructor(message: string) {\n    // Validate message parameter\n    if (typeof message !== 'string') {\n      throw new TypeError('FilterError requires a string message, got ' + typeof message);\n    }\n\n    // Remove 'filter_error: ' prefix if present for cleaner message\n    const cleanMessage = message.replace(/^filter_error:\\s*/, '').trim();\n\n    // Ensure we have a meaningful message after cleanup\n    if (!cleanMessage) {\n      super('filter_error', 'Invalid filter parameters');\n      // Warn about empty message in development\n      if (typeof console !== 'undefined' && console.warn) {\n        console.warn('FilterError created with empty message. Original:', message);\n      }\n    } else {\n      super('filter_error', cleanMessage);\n    }\n  }\n}\n\n/**\n * Thrown when native platform operation fails.\n *\n * **Common causes:**\n * - Native gallery UI failed to open\n * - Device storage access error\n * - Out of memory\n * - Platform-specific errors\n *\n * **Resolution:** Check error message for platform-specific details.\n *\n * @example\n * ```typescript\n * import { ExifGallery, NativeError } from '@kesbyte/capacitor-exif-gallery';\n *\n * try {\n *   const result = await ExifGallery.pick();\n * } catch (error) {\n *   if (error instanceof NativeError) {\n *     // Log platform-specific error for debugging\n *     console.error('Native error:', error.message);\n *\n *     // Show user-friendly message\n *     alert('Unable to open photo gallery. Please try again.');\n *   }\n * }\n * ```\n */\nexport class NativeError extends ExifGalleryError {\n  constructor(message = 'Native platform operation failed') {\n    super('native_error', message);\n  }\n}\n"]}